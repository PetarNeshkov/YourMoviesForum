@model PostDetailsViewModel

@{
    ViewData["Title"] = "Details";
}


<link href="~/css/detailsPost.css" rel="stylesheet" type="text/css" />



<body>
    <section class="main">
       <div id="header">
           <div class="top-header">
              @Model.Author.UserName
               <div>
                <i id="calendar-icon" class="calendar-icon fas fa-calendar-alt"></i>@Model.CreatedOn.ToLocalTime().ToString("g")
               </div>
            </div>
            <h2 class="mt-3">@Model.Title</h2>
            <div class="category-section">
                 <a id="anchor"
                    asp-controller="Categories" 
                    asp-action="Details" 
                    asp-route-id="@Model.Category.Id">
                     <span id="category">@Model.Category.Name</span>
                 </a>
            </div>
            <div class="tags">
             @foreach (var tag in Model.Tags)
              {
                 <a id="anchor"
                  asp-controller="Tags"
                     asp-action="Details"
                     asp-route-id="@tag.Id">
                        <span class="tagElement">
                      <i id="tag-icon" class="fas fa-tags"></i>
                      @tag.Name</span>
                  </a>                   
              }
              </div>
       </div>
       
       <div id="content">
           <p>@Html.Raw(Model.SanitizedContent)</p>
       </div>
       <div id="options">
        @if (User.Identity.IsAuthenticated)
        {
            @if (this.Model.Author.Id == this.User.Id() || User.IsAdministrator())
            {
                <a asp-controller="Posts" 
                   asp-action="Edit" 
                   asp-route-id="@Model.Id" 
                   style="color: #666f74">
                    <i class="fas fa-edit"></i>
                </a>
                <a asp-controller="Posts" 
                   asp-action="Delete" 
                   asp-route-id="@Model.Id" 
                   style="color: #666f74">
                    <i class="fas fa-trash"></i>
                </a>
            }
             <a onclick="animateButton()"
                style="cursor:pointer"
                cursor: pointer>
               <i class="fas fa-comment-dots"><use xlink:href="#icon-reply"></use></i>
             </a>           
        }
         </div>
    </section>
    <h3 class="text-center mt-4">Comments section:</h3>
    <section>
        @foreach(var reply in Model.Replies.Where(r=>r.ParentId==null))
        {
          <div class="current-element">
             <div id="header">
               <div class="top-header">
                  @reply.Author.UserName
                   <div>
                      <i id="calendar-icon" class="calendar-icon fas fa-calendar-alt"></i>@reply.CreatedOn.ToLocalTime().ToString("g")
                   </div>
               </div>
              </div>
             
               <div id="content">
                   <p>@Html.Raw(reply.SanitizedContent)</p>
               </div>
              <div id="options">
                 @if (User.Identity.IsAuthenticated)
                 {
                     @if (reply.Author.Id == this.User.Id() || User.IsAdministrator())
                     {
                         <a asp-controller="Replies" 
                            asp-action="Edit" 
                            asp-route-id="@reply.Id" 
                            style="color: #666f74">
                             <i class="fas fa-edit"></i>
                         </a>
                         <a asp-controller="Replies" 
                            asp-action="Delete" 
                            asp-route-id="@reply.Id" 
                            style="color: #666f74">
                             <i class="fas fa-trash"></i>
                         </a>
                     }
                         <a asp-controller="Replies" 
                          asp-action="Details"
                          asp-route-id="@reply.Id" 
                          style="color: #666f74">
                          <i class="fas fa-comment-dots"><use xlink:href="#icon-reply"></use></i>
                         </a>  
                 }
              </div>
           </div>
         }
    </section>
     <div id="reply-box">
         <vc:create-reply post-id="@Model.Id" parent-id="null"></vc:create-reply>
    </div>
</body>

@section Scripts{
     <partial name="_ValidationScriptsPartial" />

     <script>
      function animateButton() {
            $('html, body').animate({
                scrollTop: $("#reply-box").offset().top
            }, 1500);
        }
     </script>
}
